- name=amazon_beauty_nextitem_rankonly_gru_bs1
- detection_k=1
- num_classes=12067
- ++data_module.batch_size=1
- data_module.train_path=data/Amazon_Beauty/GTS-q0.9-val_last-test_random/train.parquet
- data_module.val_path=data/Amazon_Beauty/GTS-q0.9-val_last-test_random/val.parquet
- data_module.test_path=data/Amazon_Beauty/GTS-q0.9-val_last-test_random/test2.parquet
- +data_module.val_params.global_target_fields=[target_labels,target_timestamps]
- +data_module.test_params.global_target_fields=[target_labels,target_timestamps]
- module.loss._target_=hotpp.losses.NextItemLoss
- +module.loss.losses.labels._target_=hotpp.losses.CrossEntropyLoss
- +module.loss.losses.labels.num_classes=${num_classes}
- +module.loss.losses.timestamps._target_=hotpp.losses.TimeMAELoss
- +module.loss.losses.timestamps.delta=start
- +module.loss.losses.timestamps.max_delta=12
- ~module.loss.k
- ~module.loss.horizon
- ~module.loss.loss_subset
- ~module.loss.prefetch_factor
- ~module.loss.match_weights
- ~module.loss.next_item_adapter
- ~module.loss.next_item_loss
- ++module.val_metric._target_=hotpp.metrics.next_item_ranking.NextItemRankingMetric
- ++module.test_metric._target_=hotpp.metrics.next_item_ranking.NextItemRankingMetric
- ++module.val_metric.topk=[1,5,10,20,50,100]
- ++module.test_metric.topk=[1,5,10,20,50,100]
- trainer.model_selection.metric=val/next-item-ndcg@20
- trainer.model_selection.mode=max
- trainer.accelerator=cpu
- trainer.devices=1
- trainer.precision=32
- data_module.num_workers=0
- logger._target_=pytorch_lightning.loggers.CSVLogger
- logger.save_dir=lightning_logs
- logger.name=amazon_beauty_nextitem_rankonly_gru_bs1
- ~logger.project
